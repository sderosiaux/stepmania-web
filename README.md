# StepMania Web

A browser-based rhythm game inspired by StepMania/DDR with **precision timing** at its core.

## Features

- **Precision timing**: Sub-frame accurate audio sync, input detection, and visual feedback
- **Simple step format**: Human-readable `.stp` files that can be generated by AI
- **Classic gameplay**: StepMania-style arrows, judgments, and scoring
- **No dependencies**: Pure TypeScript, Canvas 2D rendering, Web Audio API

## Quick Start

```bash
# Install dependencies
npm install

# Start development server
npm run dev

# Run tests
npm test

# Build for production
npm run build
```

## Adding Songs

Create a folder in `songs/` with:
1. An MP3 audio file
2. A `chart.stp` step file

Example structure:
```
songs/
└── my-song/
    ├── song.mp3
    └── chart.stp
```

## Step File Format (.stp)

```
#TITLE:My Song
#ARTIST:Artist Name
#BPM:120
#MUSIC:song.mp3

//--- CHART: Easy (Level 3) ---

// Measure 1 (4 rows = quarter notes)
L...
....
...R
....
,
// Measure 2 (8 rows = eighth notes)
L...
....
.D..
....
..U.
....
...R
....
,
```

### Format Rules

- 4 columns: `L D U R` (Left, Down, Up, Right)
- `.` = no arrow, letter = arrow
- Rows per measure define division: 4=quarter, 8=eighth, 16=sixteenth
- `,` separates measures
- Jumps: multiple arrows on same row (e.g., `L..R`)

See [docs/step-format.md](docs/step-format.md) for the full specification.

## Controls

| Key | Action |
|-----|--------|
| ← ↓ ↑ → | Hit arrows |
| Enter | Confirm / Resume |
| Escape | Pause / Back |

## Timing Windows

| Judgment | Window | Score |
|----------|--------|-------|
| Marvelous | ±22.5ms | 100% |
| Perfect | ±45ms | 98% |
| Great | ±90ms | 65% |
| Good | ±135ms | 25% |
| Boo | ±180ms | 0% |
| Miss | >180ms | 0% |

## Documentation

- [Product Specification](docs/spec.md)
- [Step File Format](docs/step-format.md)
- [Test Plan](docs/tests.md)
- [Architecture Decisions](docs/decisions.md)
- [Implementation Plan](docs/implementation-plan.md)

## Tech Stack

- **Language**: TypeScript (strict mode)
- **Build**: Vite
- **Testing**: Vitest
- **Rendering**: HTML5 Canvas 2D
- **Audio**: Web Audio API
- **Frameworks**: None (vanilla)

## License

MIT
